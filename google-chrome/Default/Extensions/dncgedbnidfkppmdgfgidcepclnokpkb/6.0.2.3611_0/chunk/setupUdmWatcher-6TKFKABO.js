import{f as i}from"./chunk-ZH7EPW57.js";import"./chunk-4YBGNFWQ.js";import"./chunk-DQXOKHFD.js";import"./chunk-YJ5KKARE.js";import"./chunk-IMQHRNK4.js";import"./chunk-LI3RKPGW.js";import"./chunk-CM6X6NVN.js";function m(){return new Promise(e=>{this.addEventListener("collection-stopped",()=>{e()},{once:!0})})}async function f(e,r){if(i._demoMode)return;let n=null,t=null,s=500;this.$services.dataWorld.on("dw:document-age-updated",async c=>{if(i._demoMode)return;let{experimentId:a}=c;this.savePending=!0,!window.__isSessionClient&&(this.isCollecting&&await m.call(this),clearTimeout(n),n=setTimeout(async()=>{if(i._demoMode)return;let o=await this.$services.udm.getDocumentAge(a);if(t===void 0&&(t=o),o>t){let[{sync:l},{age:d,contentBlob:u}]=await Promise.all([import("./sync-ZU2I7IYI.js"),this.$services.dataWorld.exportData({skipWrite:!0,filename:e,filepath:`temp/${e}`})]);t=d,l(e,u,r)}},s))})}export{f as setupUdmWatcher};
